<div class="view-options">
	<h2>View Options</h2>
	
	<%= form_tag :action=>'dashboard' %>
	<div class="client-list-wrapper">
		<h3>Show these clients...</h3>
		<div class="client-list">	
			<% count = 0 %>
			<% for client in @clients %>
				<p class="<% if count % 2 == 0 %>even<% else %>odd<% end %>"><input type="checkbox" name="options[client][<%= client.id %>]" /> <label for="options[client][<%= client.id %>]"><%= client.name %></label></p>
				<% count = count + 1 %>
			<% end %>
		</div>
		<p class="small"><a href="">Select All</a> | <a href="">Select None</a></p>
	</div>
		
	<div class="dates-wrapper">
		<h3>...between these dates</h3>
		
		<div class="dates">
		<p><%= date_select( "options", "interval_start", :order=>[:day, :month, :year] ) %></p>
		<p>until</p>
		<p><%= date_select( "options", "interval_end", :order=>[:day, :month, :year] ) %></p>
		</div>
		
	</div>
	
	<div class="submit-wrapper">
		<input type="submit" value="Search" />
	</div>
	
	</form>
	
</div>

<%= render :partial=>"right_column", :locals=>{:clients=>@clients, :time_format=>@time_format, :user=>@user} %>

<% for client in @clients %>
	<div class="client">
		<h1 class="client" id="client-header-<%= client.id %>">
			<%= client.name %> 
			<span class="small">&pound;<%= '%.2f' % client.rate %>/hr</span> 
			<span class="edit-link">
				<a href="javascript:showExpenseForm( <%= client.id %> )"><img src="/images/add-expense-icon.png" alt="add an expense" title="add expense" /></a> 
				<a href="javascript:showEditClientForm( <%= client.id %> )"><img src="/images/edit-icon.png" alt="edit" title="edit" /></a> 
				<a href="javascript:confirmDelete( 'client', '/clients/destroy/<%= client.id %>' )"><img src="/images/delete-icon.png" alt="delete" title="delete" /></a>
				<% if !@limit_reached %>
				<a href="javascript:showClientForm()"><img src="/images/add-client-icon.png" alt="add a client" title="add a client" /></a> 
				<% end %>
				<a href="javascript:showClientControlsHelp()"><img src="/images/help-icon.png" alt="help" title="help" /></a>
			</span>
		</h1>
		
		<div class="edit-client" id="client-edit-<%= client.id %>">
			<% @client = client %>
			<%= render :partial=>"client_form" %>
		</div>
		
		<div class="inner" id="client-info-<%= client.id %>">
			<% @current_date = "" %>
			
			<% for item in client.combined %>
				<% if item.date.strftime( @date_format ) != @current_date %>
					<p class="interval-date"><%= item.date.strftime( @date_format ) %></p>
					<% @current_date = item.date.strftime( @date_format ) %>
				<% end %>
				<% if item.is_expense %>
					<%= render :partial=>"expense_entry", :locals=>{:expense=>item.expense} %>
				<% else %>
					<%= render :partial=>"interval_entry", :locals=>{:interval=>item.interval, :client=>client} %>
				<% end %>
			<% end %>
	
			<div class="expense_form">
				<!--<p class="entry expense-link" id="expense-link-<%= client.id %>"><a href="javascript:showExpenseForm( <%= client.id %> )">+ New expense</a></p>-->
				<% @expense = client.expenses.build %>
				<% form_for(@expense) do |f| %>			
				  <p class="entry expense-form" id="expense-form-<%= client.id %>">
		     		<input type="hidden" name="client_id" value="<%= client.id %>" />
				    <%= f.text_field :description, :value=>"Description", :class=>"inline" %>
				    <span class="value_input">&pound;<%= f.text_field :amount, :size=>"5" %></span>
				    <span class="expense_submit"><%= f.submit 'Create' %></span>
				  </p>
				<% end %>
			</div>
		</div>
	</div>
<% end %>

<% if @limit_reached %>
<p class="limit-reached">Your client limit has been reached. <a href="/upgrade">Upgrade your account</a> to add more clients.</p>
<% else %>

<% end %>

<div id="client-form">
	<% @client = Client.new %>
	<% @client.name = "Name" %>
	<%= render :partial=>"client_form" %>
</div>